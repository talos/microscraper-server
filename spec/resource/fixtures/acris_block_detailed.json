
{
    "ref" : "ACRIS-Block-Details",
    "source" : {
	"ref"   : "ACRIS-Block-Index",
	"method": "get",
	"url"   : "http://a836-acris.nyc.gov/bblsearch/bblsearch.asp?borough={{Borough}}&block={{Block}}&lot=0000"
    },
    "variables" : [
	{
	    "parser" : "Extract-Table-From-ACRIS-Index",
	    "match"  : 0,
	    "leaves" : [
		{
		    "parser" : "Extract-Table-Row",
		    "name"   : "Index Row",
		    "min"    : 0,
		    "max"    : -1,
		    "pipes"  : ["ACRIS-Index-Row"]
		}
	    ]
	}
    ],
    "leaves" : [
	{
	    "parser" : "Extract-Doc-IDs-From-ACRIS-Index",
	    "name"   : "Document ID",
	    "min"    : 0,
	    "max"    : -1,
	    "pipes"  : ["ACRIS-Detailed"]
	}
    ],
    "parsers":[
	{
	    "ref"    : "Extract-Doc-IDs-From-ACRIS-Index",
	    "pattern": "JavaScript:go_detail\\('(\\d+)'\\)",
	    "replacement": "\\1"
	},
	{
	    "ref"    : "Extract-Table-From-ACRIS-Index",
	    "pattern": "<!--Table Begin!-->(.*?)<!--Table End-->",
	    "replacement": "\\1"
	},
	{
	    "ref"    : "Extract-Table-Row",
	    "pattern": "<tr(.*?)</tr>",
	    "replacement": "\\1"
	}
    ],
    "scrapers":[
	{
	    "ref": "ACRIS-Detailed",
	    "source": [{
		"ref"   : "ACRIS-Detailed-View",
		"method": "get",
		"url"   : "http://a836-acris.nyc.gov/Scripts/DocSearch.dll/Detail?Doc_ID={{Document ID}}"
	    }],
	    "leaves"  : [
		{
		    "parser": "Extract-ACRIS-Detailed-Party1-Table",
		    "name"  : "Party1 Table",
		    "min"   :  0,
		    "max"   : -1,
		    "name"  : "Detailed Row",
		    "pipe"  : ["ACRIS-Detailed-Row"]
		},
		{
		    "parser" : "Extract-ACRIS-Detailed-Party2-Table",
		    "name"   : "Party2 Table",
		    "min"    :  0,
		    "max"    : -1,
		    "name"   : "Detailed Row",
		    "pipe"   : ["ACRIS-Detailed-Row"]
		}	    
	    ],
	    "parsers": [
		{
		    "ref"         : "Extract-ACRIS-Detailed-Party1-Table",
		    "pattern"     : "PARTY 1.*?<table.*?(<table.*?</table>)",
		    "replacement" : "\\1"
		},
		{
		    "ref"         : "Extract-ACRIS-Detailed-Party2-Table",
		    "pattern"     : "PARTY 2.*?<table.*?(<table.*?</table>)",
		    "replacement" : "\\1"
		}
	    ],
	    "scrapers": [
		{
		    "ref" : "ACRIS-Detailed-Row",
		    "source" : "{{Detailed Row}}",
		    "variables"  : [
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "Name",
			    "match"  : 0
			},
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "Address 1",
			    "match"  : 1
			},
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "Address 2",
			    "match"  : 2
			},
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "City",
			    "match"  : 3
			},
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "State",
			    "match"  : 4
			},
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "Zip",
			    "match"  : 5
			},
			{
			    "parser" : "Find-Cell-Content",
			    "name"   : "Country",
			    "match"  : 6
			}
		    ],
		    "parsers": [{
			"ref" : "Find-Cell-Content",
			"pattern": "<td(.*?)</td>",
			"replacement": "\\1"
		    }]
		},
		{
		    "ref" : "ACRIS-Index-Row",
		    "source" : "{{Index Row}}",
		}
	    ]
	}
    ]
}
